<template name="answer_draw_at_a_location">
  <div class="row" style="margin-top: 20px;">
    {{#if group.use_map}}
    <div class="col s3">
      <div style="width: 100%; height: 300px;" class="grey lighten-3">
        <div style="width: 100%; height: 0px;">
          <button id="btn_zoomout" class="toolbar_button waves-effect waves-light btn-floating white-text purple"><i class="mdi-content-remove"></i></button>
          <button id="btn_zoomin" class="toolbar_button waves-effect waves-light btn-floating white-text purple"><i class="mdi-content-add"></i></button>
        </div>
        <div style="width: 100%; height: 100%;" id="map_wrapper">
          <div class="answer-leaflet-map">
            <div id='answer-map'></div>
          </div>
          {{fire_for_answer_draw}}
        </div>
      </div>
    </div>
    {{/if}}
    <div class="col {{#if group.use_map}}s9{{else}}s11 offset-s1{{/if}}">
      {{#each questions_in_group}}
        <!-- Use has_decision_point qig_id here -->
        <div style="width: 100%;">{{> question_to_answer question_id}}</div>
      {{/each}}
    </div>
  </div>
</template>

<template name="question_to_answer">
  {{#with question this}}
    <div class="col s12 card grey lighten-3">
      <div class="card-content">
        <form id="{{_id}}">
          <input type="hidden" name="question_id" value="{{_id}}" />

        {{#if is_multiple_choice _id}}
          <div class="row" style="margin-bottom: 20px;">
            <div class="input-field col s11">
              <select id="ans_{{_id}}" name="answer" class="multiple_choice_answer">
                <option value="">No Answer Given for Multiple Choice</option>
              {{#each allowed_values}}
                {{#if matched value "value"}}
                  <option value="{{value}}" selected>{{value}}</option>
                {{else}}
                  <option value="{{value}}">{{value}}</option>
                {{/if}}
              {{/each}}
              </select>
              <label>{{text}}</label>
            </div>
          </div>
        {{/if}}

        {{#if is_geo_point _id}}
          <div class="row" style="margin-bottom: 40px;">
            <div class="grey-text" style="font-size: 9pt; margin-bottom: 5px;">{{text}}</div>
            <div class="input-field col s12">
              {{#if has_answer _id}}
                <button type="button" id="btn_{{_id}}" class="btn btn-invisible btn-geo-point btn-geo waves-effect waves-light teal"><i class="mdi-content-add left"></i>{{label}}</button>
                <button type="button" class="btn btn-invisible btn-save waves-effect waves-light teal">Save</button>
                <button type="button" class="btn btn-delete waves-effect waves-light teal">Delete</button>
              {{else}}
                <button type="button" id="btn_{{_id}}" class="btn btn-geo-point btn-geo waves-effect waves-light teal"><i class="mdi-content-add left"></i>{{label}}</button>
                <button type="button" class="btn btn-invisible btn-save waves-effect waves-light teal">Save</button>
                <button type="button" class="btn btn-invisible btn-delete waves-effect waves-light teal">Delete</button>
              {{/if}}
            </div>
          </div>
        {{/if}}

        {{#if is_geo_area _id}}
          <div class="row" style="margin-bottom: 40px;">
            <div class="grey-text" style="font-size: 9pt; margin-bottom: 5px;">{{text}}</div>
            <div class="input-field col s12">
              {{#if has_answer _id}}
                <button type="button" id="btn_{{_id}}" class="btn btn-invisible btn-geo-area btn-geo waves-effect waves-light teal"><i class="mdi-content-add left"></i>{{label}}</button>
                <button type="button" class="btn btn-invisible btn-save waves-effect waves-light teal">Save</button>
                <button type="button" class="btn btn-delete waves-effect waves-light teal">Delete</button>
              {{else}}
                <button type="button" id="btn_{{_id}}" class="btn btn-geo-area btn-geo waves-effect waves-light teal"><i class="mdi-content-add left"></i>{{label}}</button>
                <button type="button" class="btn btn-invisible btn-save waves-effect waves-light teal">Save</button>
                <button type="button" class="btn btn-invisible btn-delete waves-effect waves-light teal">Delete</button>
              {{/if}}
            </div>
          </div>
        {{/if}}

        {{#if is_numeric _id}}
          <div class="row" style="margin-bottom: 20px;">
            <div class="input-field col s9">
              <input type="text" class="numeric_answer_value" id="ans_val_{{_id}}" value="{{number_value _id}}"/>
              <label for="value_{{_id}}">{{text}}</label>
            </div>
            <div class="input-field col s3">
              <select class="numeric_answer_unit" id="units_{{_id}}">
                <option value="">No Units</option>
                {{#each possible_units}}
                  {{#if matched unit "units"}}
                    <option value="{{unit}}" selected>{{unit}}</option>
                  {{else}}
                    <option value="{{unit}}">{{unit}}</option>
                  {{/if}}
                {{/each}}
              </select>
              <label for="units_{{_id}}">Units</label>
            </div>
          </div>
        {{/if}}

        {{#if is_year _id}}
          <div class="row" style="margin-bottom: 20px;">
            <div class="input-field col s11">
              <select name="answer" id="ans_{{_id}}" class="year_answer">
                <option value="">No Answer Given</option>
                {{#each years_for_year_question _id}}
                  {{#if matched year "value"}}
                    <option value="{{year}}" selected>{{year}}</option>
                  {{else}}
                    <option value="{{year}}">{{year}}</option>
                  {{/if}}
                <!-- Need a way to display all the of the years from min to current year -->
                {{/each}}
              </select>
              <label for="year_{{_id}}">{{text}}</label>
            </div>
          </div>
        {{/if}}
        <div id="comment_{{_id}}" class="row" style="display: none; padding-bottom: 20px;">
          <div class="input-field col s12">
            <input type="text" name="comment" id="comments_{{_id}}" value="{{comment _id}}"/>
            <label for="comments_{{_id}}">Comments</label>
          </div>
        </div>
      </form>
      <div id="help_text_{{_id}}" class="row" style="display: none; padding-bottom: 20px;">
        <div class="col s12">
          <h4>Need Help?</h4>
          <div id="help_text_content_{{_id}}"></div>
        </div>
      </div>
      <div class="row">
        <div class="col s3"><button class="photo tooltipped waves-effect waves-teal btn-flat btn-large transparent disabled" data-position="bottom" data-delay="50" data-tooltip="Photos"><i class="mdi-editor-insert-photo"></i></button></div>
        <div class="col s3"><button class="comment tooltipped waves-effect waves-teal btn-flat btn-large transparent {{#if has_comment}}green-text{{else}}teal-text{{/if}}"  data-position="bottom" data-delay="50" data-tooltip="Comments" disabled="{{#unless has_answer _id}}true{{/unless}}"  ><i class="{{#if has_comment}}mdi-communication-chat{{else}}mdi-communication-messenger{{/if}}"></i></button></div>
        {{#if has_help_text _id}}
          <div class="col s3"><button id="help_{{_id}}" class="help tooltipped waves-effect waves-teal btn-flat btn-large transparent teal-text" data-position="bottom" data-delay="50" data-tooltip="Help"><i class="mdi-communication-live-help"></i></button></div>
        {{/if}}

      </div>
    </div>
  </div>
  {{/with}}
</template>
